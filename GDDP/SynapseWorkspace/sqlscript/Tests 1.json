{
	"name": "Tests 1",
	"properties": {
		"content": {
			"query": "\n-- 1. select simple (describe columns + where)\nSELECT TOP 10 rows.*\nFROM OPENROWSET(\n      PROVIDER = 'CosmosDB',\n      CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n      OBJECT = 'Volcano',\n      SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n    ) \n    as rows\n--WHERE rows.Country='Japan'\n--WHERE rows.PLID is not null\n\n-- 2. select simple (JSON_VALUE)\nSELECT TOP 10 JSON_VALUE(rows.Location, '$.type') as loc_type, \n    JSON_VALUE(rows.Location, '$.coordinates[0]') as Longitude, JSON_VALUE(rows.Location, '$.coordinates[1]') as Latitude, \n    rows.*\nFROM OPENROWSET(\n      PROVIDER = 'CosmosDB',\n      CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n      OBJECT = 'Volcano',\n      SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n    ) \n    as rows\nWHERE rows.Country='Japan'\n\n-- 3. select WITH schema + CROSS APPLY OPENJSON\nSELECT TOP 10 rows.*, loc.*\nFROM OPENROWSET(\n      PROVIDER = 'CosmosDB',\n      CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n      OBJECT = 'Volcano',\n      SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n    ) \n    WITH( \n        location_type varchar(32) '$.Location.type',\n        Country varchar(128),\n        [Status] varchar(128),\n        [Volcano Name] varchar(128),\n        [Type] varchar(128),\n        [Region] varchar(128),\n        [Location] varchar(128)\n     ) \n    as rows\n    CROSS APPLY OPENJSON ( rows.Location ) \n        WITH (\n            type varchar(16),\n            latitude float '$.coordinates[0]',\n            longitude float '$.coordinates[1]'\n        ) as loc\n\n\n-- 4. SELECT JOIN between 2 cosmosdb containers\n;with devices as (\n    SELECT rowsdevices.*\n    FROM OPENROWSET(\n        PROVIDER = 'CosmosDB',\n        CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n        OBJECT = 'IoTDeviceInfo',\n        SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n        ) as rowsdevices\n)\nSELECT rows.*, devices.Rotortype\nFROM OPENROWSET(\n      PROVIDER = 'CosmosDB',\n      CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n      OBJECT = 'IoTSignals',\n      SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n    ) as rows\ninner join devices on devices.Deviceid=rows.DeviceId\n\n-- 5. SELECT JOIN + GROUP BY\nselect a.Deviceid \n        , b.Devicetype \n        , cast(b.Location as varchar(128)) as Location\n        , cast(b.Latitude as float) as Latitude\n        , cast(b.Longitude as float) as  Longitude\n        , a.Measuretype \n        , a.UnitSymbol \n        , cast(sum(MeasureValue) as float) as MeasureValueSum \n        , count(*) as count \nfrom OPENROWSET(\n    PROVIDER = 'CosmosDB',\n    CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n    OBJECT = 'IoTSignals',\n    SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n    ) as a \nleft join OPENROWSET(\n        PROVIDER = 'CosmosDB',\n        CONNECTION = 'Account=playgroundeu2;Database=Volcano;',\n        OBJECT = 'IoTDeviceInfo',\n        SERVER_CREDENTIAL  = 'MyCosmosDbAccountCredential'\n        ) as b \non a.Deviceid = b.Deviceid \nwhere a.unitSymbol = 'RPM' \ngroup by a.Deviceid, b.Devicetype, b.Location, b.Latitude, b.Longitude, a.Measuretype, a.UnitSymbol\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"name": "master",
				"type": "SqlOnDemand"
			}
		},
		"type": "SqlQuery"
	}
}